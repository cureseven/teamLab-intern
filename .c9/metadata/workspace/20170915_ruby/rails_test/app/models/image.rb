{"filter":false,"title":"image.rb","tooltip":"/20170915_ruby/rails_test/app/models/image.rb","undoManager":{"mark":32,"position":32,"stack":[[{"start":{"row":0,"column":31},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":2},{"start":{"row":1,"column":0},"end":{"row":1,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":1,"column":4},"end":{"row":2,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":2,"column":0},"end":{"row":2,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":2,"column":4},"end":{"row":41,"column":7},"action":"insert","lines":["  def index","    @images = Image.limit(20)","  end","","  def new ","    @image = Image.new","  end ","","  def create","    upload_file = image_params[:file]","    image = {}","    if upload_file != nil ","      image[:filename] = upload_file.original_filename","      image[:file] = upload_file.read","    end ","    @image = Image.new(image)","    if @image.save","      flash[:success] = “画像を保存しました。”","      redirect_to @image","    else","      flash[:error] = “保存できませんでした。”","    end ","  end","","  def show_image","","    # send_dataはバイナリファイルをブラウザに表示するため","    # http://railsdoc.com/references/send_data","","    @image = Image.find(params[:id])","    send_data @image.file, :type => 'image/jpeg', :disposition => 'inline'","  end","","  private","","    def image_params","      params.require(:image).permit(","        :filename,:file","      )   ","    end"],"id":4}],[{"start":{"row":41,"column":7},"end":{"row":42,"column":0},"action":"insert","lines":["",""],"id":5},{"start":{"row":42,"column":0},"end":{"row":42,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":4},"action":"remove","lines":["    "],"id":6}],[{"start":{"row":9,"column":0},"end":{"row":25,"column":0},"action":"remove","lines":["","  def create","    upload_file = image_params[:file]","    image = {}","    if upload_file != nil ","      image[:filename] = upload_file.original_filename","      image[:file] = upload_file.read","    end ","    @image = Image.new(image)","    if @image.save","      flash[:success] = “画像を保存しました。”","      redirect_to @image","    else","      flash[:error] = “保存できませんでした。”","    end ","  end",""],"id":7}],[{"start":{"row":9,"column":0},"end":{"row":10,"column":0},"action":"remove","lines":["",""],"id":8}],[{"start":{"row":9,"column":0},"end":{"row":10,"column":0},"action":"insert","lines":["",""],"id":9}],[{"start":{"row":16,"column":74},"end":{"row":17,"column":0},"action":"insert","lines":["",""],"id":13},{"start":{"row":17,"column":0},"end":{"row":17,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":18,"column":5},"end":{"row":19,"column":0},"action":"insert","lines":["",""],"id":14},{"start":{"row":19,"column":0},"end":{"row":19,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":19,"column":2},"end":{"row":20,"column":0},"action":"remove","lines":["",""],"id":16}],[{"start":{"row":11,"column":0},"end":{"row":14,"column":0},"action":"remove","lines":["","    # send_dataはバイナリファイルをブラウザに表示するため","    # http://railsdoc.com/references/send_data",""],"id":17}],[{"start":{"row":9,"column":0},"end":{"row":10,"column":0},"action":"insert","lines":["",""],"id":18}],[{"start":{"row":10,"column":0},"end":{"row":12,"column":6},"action":"insert","lines":["  def new ","    @image = Image.new","  end "],"id":19}],[{"start":{"row":12,"column":6},"end":{"row":13,"column":0},"action":"insert","lines":["",""],"id":20},{"start":{"row":13,"column":0},"end":{"row":13,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":10,"column":6},"end":{"row":10,"column":9},"action":"remove","lines":["new"],"id":21},{"start":{"row":10,"column":6},"end":{"row":10,"column":7},"action":"insert","lines":["s"]}],[{"start":{"row":10,"column":7},"end":{"row":10,"column":8},"action":"insert","lines":["h"],"id":22}],[{"start":{"row":10,"column":8},"end":{"row":10,"column":9},"action":"insert","lines":["o"],"id":23}],[{"start":{"row":10,"column":9},"end":{"row":10,"column":10},"action":"insert","lines":["w"],"id":24}],[{"start":{"row":16,"column":0},"end":{"row":17,"column":74},"action":"remove","lines":["    @image = Image.find(params[:id])","    send_data @image.file, :type => 'image/jpeg', :disposition => 'inline'"],"id":25}],[{"start":{"row":11,"column":0},"end":{"row":11,"column":22},"action":"remove","lines":["    @image = Image.new"],"id":26},{"start":{"row":11,"column":0},"end":{"row":12,"column":74},"action":"insert","lines":["    @image = Image.find(params[:id])","    send_data @image.file, :type => 'image/jpeg', :disposition => 'inline'"]}],[{"start":{"row":14,"column":2},"end":{"row":20,"column":2},"action":"remove","lines":["","  def show_image","","","    ","  end","  "],"id":27}],[{"start":{"row":14,"column":2},"end":{"row":22,"column":2},"action":"remove","lines":["","  private","","    def image_params","      params.require(:image).permit(","        :filename,:file","      )   ","    end","  "],"id":28}],[{"start":{"row":10,"column":10},"end":{"row":10,"column":11},"action":"remove","lines":[" "],"id":29}],[{"start":{"row":1,"column":4},"end":{"row":8,"column":6},"action":"remove","lines":["","  def index","    @images = Image.limit(20)","  end","","  def new ","    @image = Image.new","  end "],"id":30}],[{"start":{"row":1,"column":4},"end":{"row":2,"column":0},"action":"remove","lines":["",""],"id":31}],[{"start":{"row":3,"column":36},"end":{"row":4,"column":0},"action":"insert","lines":["",""],"id":32},{"start":{"row":4,"column":0},"end":{"row":4,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":4,"column":4},"end":{"row":5,"column":0},"action":"insert","lines":["",""],"id":33},{"start":{"row":5,"column":0},"end":{"row":5,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":3,"column":36},"end":{"row":5,"column":4},"action":"remove","lines":["","    ","    "],"id":35}],[{"start":{"row":3,"column":36},"end":{"row":3,"column":37},"action":"insert","lines":[" "],"id":36}],[{"start":{"row":3,"column":36},"end":{"row":3,"column":37},"action":"remove","lines":[" "],"id":37}],[{"start":{"row":2,"column":0},"end":{"row":5,"column":6},"action":"remove","lines":["  def show","    @image = Image.find(params[:id])","    send_data @image.file, :type => 'image/jpeg', :disposition => 'inline'","  end "],"id":38}],[{"start":{"row":1,"column":0},"end":{"row":3,"column":4},"action":"remove","lines":["    ","","    "],"id":39}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":1,"column":0},"end":{"row":1,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1505467597741,"hash":"52e09c769ac9fe1a39492852e1f093b1f8181175"}